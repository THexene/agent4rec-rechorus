Namespace(vis=-1, seed=101, clear_checkpoints=False, candidate=False, test_only=False, data_path='../datasets/', dataset='ml-1m', embed_size=64, batch_size=2048, lr=0.0005, regs=1e-05, epoch=2000, Ks=20, verbose=5, saveID='', patience=10, checkpoint='./', modeltype='MF', cuda=0, IPStype='cn', n_layers=0, max2keep=1, infonce=0, neg_sample=1, num_workers=8, train_norm=False, pred_norm=False, nodrop=False, no_wandb=True)
Epoch 0 [23.0s]: train==[0.69258, 0.69258, 0.00000]
Epoch 1 [20.2s]: train==[0.69125, 0.69125, 0.00000]
Epoch 2 [19.6s]: train==[0.68968, 0.68968, 0.00000]
Epoch 3 [19.6s]: train==[0.68764, 0.68764, 0.00000]
Epoch 4 [19.5s]: train==[0.68488, 0.68487, 0.00000]
valid:{'recall': 0.027546195, 'hit_ratio': 0.591, 'precision': 0.064099826, 'ndcg': 0.07097225, 'mrr': 0.19436525, 'map': 0.15797782}
test:{'recall': 0.026846033, 'hit_ratio': 0.594, 'precision': 0.06294979, 'ndcg': 0.07331009, 'mrr': 0.21270972, 'map': 0.17378303}
Epoch 5 [20.3s]: train==[0.68061, 0.68061, 0.00000]
Epoch 6 [19.7s]: train==[0.67393, 0.67392, 0.00000]
Epoch 7 [19.7s]: train==[0.66330, 0.66330, 0.00000]
Epoch 8 [19.4s]: train==[0.64678, 0.64678, 0.00000]
Epoch 9 [19.4s]: train==[0.62329, 0.62329, 0.00000]
valid:{'recall': 0.101258524, 'hit_ratio': 0.901, 'precision': 0.2211503, 'ndcg': 0.24637766, 'mrr': 0.45982236, 'map': 0.3653654}
test:{'recall': 0.10290319, 'hit_ratio': 0.91, 'precision': 0.22220013, 'ndcg': 0.24695781, 'mrr': 0.46690956, 'map': 0.3652849}
Epoch 10 [19.3s]: train==[0.59214, 0.59213, 0.00001]
Epoch 11 [19.2s]: train==[0.55502, 0.55501, 0.00001]
Epoch 12 [19.9s]: train==[0.51615, 0.51614, 0.00001]
Epoch 13 [19.5s]: train==[0.47796, 0.47795, 0.00001]
Epoch 14 [19.4s]: train==[0.44474, 0.44472, 0.00001]
valid:{'recall': 0.11146374, 'hit_ratio': 0.908, 'precision': 0.23905016, 'ndcg': 0.2686526, 'mrr': 0.49685177, 'map': 0.39090782}
test:{'recall': 0.11151581, 'hit_ratio': 0.933, 'precision': 0.23840027, 'ndcg': 0.26884243, 'mrr': 0.50508195, 'map': 0.39917076}
Epoch 15 [19.5s]: train==[0.41526, 0.41524, 0.00001]
Epoch 16 [19.3s]: train==[0.39319, 0.39318, 0.00002]
Epoch 17 [19.4s]: train==[0.37296, 0.37294, 0.00002]
Epoch 18 [19.4s]: train==[0.35774, 0.35772, 0.00002]
Epoch 19 [19.4s]: train==[0.34533, 0.34531, 0.00002]
valid:{'recall': 0.11602901, 'hit_ratio': 0.924, 'precision': 0.24630027, 'ndcg': 0.2791775, 'mrr': 0.5166627, 'map': 0.40771115}
test:{'recall': 0.114017025, 'hit_ratio': 0.934, 'precision': 0.24295025, 'ndcg': 0.276596, 'mrr': 0.52414775, 'map': 0.40976003}
Epoch 20 [19.9s]: train==[0.33630, 0.33628, 0.00002]
Epoch 21 [19.4s]: train==[0.32469, 0.32467, 0.00002]
Epoch 22 [19.5s]: train==[0.31795, 0.31792, 0.00003]
Epoch 23 [19.4s]: train==[0.31034, 0.31031, 0.00003]
Epoch 24 [19.4s]: train==[0.30386, 0.30383, 0.00003]
valid:{'recall': 0.11781333, 'hit_ratio': 0.921, 'precision': 0.24995029, 'ndcg': 0.28673753, 'mrr': 0.5508789, 'map': 0.4220841}
test:{'recall': 0.11702349, 'hit_ratio': 0.938, 'precision': 0.24785018, 'ndcg': 0.28645638, 'mrr': 0.55615044, 'map': 0.42607096}
Epoch 25 [19.3s]: train==[0.29757, 0.29755, 0.00003]
Epoch 26 [19.2s]: train==[0.29223, 0.29220, 0.00003]
Epoch 27 [19.0s]: train==[0.28848, 0.28845, 0.00003]
Epoch 28 [19.0s]: train==[0.28106, 0.28103, 0.00003]
Epoch 29 [19.0s]: train==[0.27686, 0.27683, 0.00003]
valid:{'recall': 0.12160955, 'hit_ratio': 0.927, 'precision': 0.2570503, 'ndcg': 0.29637367, 'mrr': 0.5680472, 'map': 0.43648717}
test:{'recall': 0.1226747, 'hit_ratio': 0.941, 'precision': 0.2579501, 'ndcg': 0.29762453, 'mrr': 0.5736584, 'map': 0.43473357}
Epoch 30 [19.0s]: train==[0.27181, 0.27178, 0.00003]
Epoch 31 [19.0s]: train==[0.26865, 0.26862, 0.00003]
Epoch 32 [19.1s]: train==[0.26318, 0.26314, 0.00004]
Epoch 33 [19.0s]: train==[0.25706, 0.25703, 0.00004]
Epoch 34 [19.1s]: train==[0.25482, 0.25478, 0.00004]
valid:{'recall': 0.12698023, 'hit_ratio': 0.938, 'precision': 0.2640503, 'ndcg': 0.30553696, 'mrr': 0.581151, 'map': 0.4467039}
test:{'recall': 0.12697618, 'hit_ratio': 0.947, 'precision': 0.26500005, 'ndcg': 0.3061375, 'mrr': 0.5822171, 'map': 0.4445595}
Epoch 35 [19.0s]: train==[0.24957, 0.24953, 0.00004]
Epoch 36 [19.0s]: train==[0.24623, 0.24619, 0.00004]
Epoch 37 [19.0s]: train==[0.24431, 0.24427, 0.00004]
Epoch 38 [19.1s]: train==[0.23854, 0.23850, 0.00004]
Epoch 39 [19.1s]: train==[0.23290, 0.23286, 0.00004]
valid:{'recall': 0.1316297, 'hit_ratio': 0.942, 'precision': 0.2747503, 'ndcg': 0.31688893, 'mrr': 0.5933076, 'map': 0.45567238}
test:{'recall': 0.13170408, 'hit_ratio': 0.95, 'precision': 0.27409998, 'ndcg': 0.31551063, 'mrr': 0.58719844, 'map': 0.45083973}
Epoch 40 [19.1s]: train==[0.23427, 0.23423, 0.00004]
Epoch 41 [19.2s]: train==[0.23007, 0.23003, 0.00004]
Epoch 42 [19.1s]: train==[0.22670, 0.22665, 0.00004]
Epoch 43 [19.1s]: train==[0.22164, 0.22159, 0.00005]
Epoch 44 [19.1s]: train==[0.21828, 0.21823, 0.00005]
valid:{'recall': 0.13595945, 'hit_ratio': 0.947, 'precision': 0.28370017, 'ndcg': 0.32631728, 'mrr': 0.6021927, 'map': 0.46519077}
test:{'recall': 0.13677618, 'hit_ratio': 0.955, 'precision': 0.28490007, 'ndcg': 0.32655066, 'mrr': 0.59758604, 'map': 0.4587791}
Epoch 45 [18.9s]: train==[0.21741, 0.21737, 0.00005]
Epoch 46 [19.0s]: train==[0.21284, 0.21280, 0.00005]
Epoch 47 [19.2s]: train==[0.21225, 0.21220, 0.00005]
Epoch 48 [19.0s]: train==[0.20696, 0.20691, 0.00005]
Epoch 49 [19.0s]: train==[0.20498, 0.20493, 0.00005]
valid:{'recall': 0.13797651, 'hit_ratio': 0.946, 'precision': 0.29035008, 'ndcg': 0.33416122, 'mrr': 0.6104644, 'map': 0.47283253}
test:{'recall': 0.14215441, 'hit_ratio': 0.954, 'precision': 0.2958, 'ndcg': 0.33639973, 'mrr': 0.6001807, 'map': 0.46399775}
Epoch 50 [19.0s]: train==[0.20227, 0.20222, 0.00005]
Epoch 51 [19.0s]: train==[0.19757, 0.19752, 0.00005]
Epoch 52 [19.0s]: train==[0.19657, 0.19652, 0.00005]
Epoch 53 [19.0s]: train==[0.19362, 0.19357, 0.00005]
Epoch 54 [19.1s]: train==[0.19162, 0.19156, 0.00005]
valid:{'recall': 0.1409135, 'hit_ratio': 0.944, 'precision': 0.29680002, 'ndcg': 0.3399307, 'mrr': 0.6144336, 'map': 0.4758827}
test:{'recall': 0.14412186, 'hit_ratio': 0.957, 'precision': 0.30089983, 'ndcg': 0.34152153, 'mrr': 0.604693, 'map': 0.46873647}
Epoch 55 [19.1s]: train==[0.18974, 0.18968, 0.00005]
Epoch 56 [19.0s]: train==[0.18599, 0.18594, 0.00006]
Epoch 57 [19.1s]: train==[0.18228, 0.18222, 0.00006]
Epoch 58 [18.9s]: train==[0.18153, 0.18147, 0.00006]
Epoch 59 [19.0s]: train==[0.17971, 0.17965, 0.00006]
valid:{'recall': 0.14300236, 'hit_ratio': 0.95, 'precision': 0.30170012, 'ndcg': 0.3456652, 'mrr': 0.6218419, 'map': 0.482255}
test:{'recall': 0.14607081, 'hit_ratio': 0.958, 'precision': 0.30489984, 'ndcg': 0.34641507, 'mrr': 0.6103093, 'map': 0.47633052}
Epoch 60 [19.1s]: train==[0.17943, 0.17937, 0.00006]
Epoch 61 [19.2s]: train==[0.17557, 0.17551, 0.00006]
Epoch 62 [19.2s]: train==[0.17190, 0.17184, 0.00006]
Epoch 63 [19.2s]: train==[0.17236, 0.17230, 0.00006]
Epoch 64 [19.0s]: train==[0.17084, 0.17078, 0.00006]
valid:{'recall': 0.14510068, 'hit_ratio': 0.949, 'precision': 0.30539992, 'ndcg': 0.34843963, 'mrr': 0.6215503, 'map': 0.48065493}
test:{'recall': 0.14801243, 'hit_ratio': 0.967, 'precision': 0.30899984, 'ndcg': 0.35019282, 'mrr': 0.6118238, 'map': 0.48107585}
Epoch 65 [19.1s]: train==[0.16684, 0.16677, 0.00006]
Epoch 66 [19.2s]: train==[0.16464, 0.16457, 0.00006]
Epoch 67 [19.0s]: train==[0.16171, 0.16164, 0.00006]
Epoch 68 [19.2s]: train==[0.16167, 0.16161, 0.00007]
Epoch 69 [19.1s]: train==[0.15985, 0.15979, 0.00007]
valid:{'recall': 0.1468429, 'hit_ratio': 0.955, 'precision': 0.30790004, 'ndcg': 0.3507993, 'mrr': 0.6224571, 'map': 0.4804349}
test:{'recall': 0.14886937, 'hit_ratio': 0.966, 'precision': 0.31034976, 'ndcg': 0.35196087, 'mrr': 0.61778754, 'map': 0.4799178}
Epoch 70 [18.9s]: train==[0.16023, 0.16017, 0.00007]
Epoch 71 [19.0s]: train==[0.15862, 0.15855, 0.00007]
Epoch 72 [19.0s]: train==[0.15587, 0.15580, 0.00007]
Epoch 73 [19.4s]: train==[0.15301, 0.15295, 0.00007]
Epoch 74 [19.2s]: train==[0.15364, 0.15357, 0.00007]
valid:{'recall': 0.14775807, 'hit_ratio': 0.952, 'precision': 0.30965006, 'ndcg': 0.35258612, 'mrr': 0.6216557, 'map': 0.4813145}
test:{'recall': 0.14930934, 'hit_ratio': 0.966, 'precision': 0.31219986, 'ndcg': 0.35397848, 'mrr': 0.6205662, 'map': 0.48090753}
Epoch 75 [19.2s]: train==[0.15180, 0.15173, 0.00007]
Epoch 76 [19.2s]: train==[0.14946, 0.14939, 0.00007]
Epoch 77 [19.1s]: train==[0.14751, 0.14743, 0.00007]
Epoch 78 [19.1s]: train==[0.14724, 0.14717, 0.00007]
Epoch 79 [19.3s]: train==[0.14623, 0.14616, 0.00007]
valid:{'recall': 0.14876758, 'hit_ratio': 0.952, 'precision': 0.31094998, 'ndcg': 0.35318083, 'mrr': 0.6178487, 'map': 0.48019463}
test:{'recall': 0.15004107, 'hit_ratio': 0.966, 'precision': 0.31374988, 'ndcg': 0.35558888, 'mrr': 0.6230242, 'map': 0.4818351}
Epoch 80 [19.2s]: train==[0.14439, 0.14431, 0.00007]
Epoch 81 [19.1s]: train==[0.14344, 0.14337, 0.00007]
Epoch 82 [19.4s]: train==[0.14200, 0.14193, 0.00008]
Epoch 83 [19.0s]: train==[0.14157, 0.14150, 0.00008]
Epoch 84 [19.2s]: train==[0.13981, 0.13973, 0.00008]
valid:{'recall': 0.14908111, 'hit_ratio': 0.952, 'precision': 0.31369987, 'ndcg': 0.3552816, 'mrr': 0.62060034, 'map': 0.481097}
test:{'recall': 0.15061444, 'hit_ratio': 0.969, 'precision': 0.31484988, 'ndcg': 0.3561375, 'mrr': 0.6216373, 'map': 0.48193344}
Epoch 85 [19.1s]: train==[0.13857, 0.13849, 0.00008]
Epoch 86 [19.1s]: train==[0.13581, 0.13573, 0.00008]
Epoch 87 [19.2s]: train==[0.13466, 0.13458, 0.00008]
Epoch 88 [19.3s]: train==[0.13483, 0.13475, 0.00008]
Epoch 89 [19.0s]: train==[0.13338, 0.13330, 0.00008]
valid:{'recall': 0.14904912, 'hit_ratio': 0.952, 'precision': 0.31429994, 'ndcg': 0.3563759, 'mrr': 0.62600446, 'map': 0.48267537}
test:{'recall': 0.14927347, 'hit_ratio': 0.968, 'precision': 0.31369987, 'ndcg': 0.35554287, 'mrr': 0.62328076, 'map': 0.4840651}
Epoch 90 [19.1s]: train==[0.13449, 0.13441, 0.00008]
Epoch 91 [19.2s]: train==[0.13038, 0.13030, 0.00008]
Epoch 92 [19.0s]: train==[0.13059, 0.13051, 0.00008]
Epoch 93 [19.3s]: train==[0.12977, 0.12969, 0.00008]
Epoch 94 [19.6s]: train==[0.12943, 0.12934, 0.00008]
valid:{'recall': 0.14795883, 'hit_ratio': 0.951, 'precision': 0.31370023, 'ndcg': 0.35452682, 'mrr': 0.61932224, 'map': 0.47947007}
test:{'recall': 0.14966032, 'hit_ratio': 0.964, 'precision': 0.3146498, 'ndcg': 0.35520294, 'mrr': 0.61635756, 'map': 0.48133168}
Epoch 95 [19.2s]: train==[0.12723, 0.12715, 0.00008]
Epoch 96 [19.2s]: train==[0.12612, 0.12603, 0.00009]
Epoch 97 [19.2s]: train==[0.12492, 0.12483, 0.00009]
Epoch 98 [19.2s]: train==[0.12586, 0.12577, 0.00009]
Epoch 99 [19.3s]: train==[0.12366, 0.12358, 0.00009]
valid:{'recall': 0.14920262, 'hit_ratio': 0.954, 'precision': 0.31385, 'ndcg': 0.35502076, 'mrr': 0.6187666, 'map': 0.48057222}
test:{'recall': 0.14905207, 'hit_ratio': 0.964, 'precision': 0.3142497, 'ndcg': 0.35484475, 'mrr': 0.6164431, 'map': 0.4816621}
Epoch 100 [19.1s]: train==[0.12108, 0.12099, 0.00009]
Epoch 101 [19.0s]: train==[0.12344, 0.12335, 0.00009]
Epoch 102 [19.3s]: train==[0.12027, 0.12018, 0.00009]
Epoch 103 [19.1s]: train==[0.11910, 0.11901, 0.00009]
Epoch 104 [19.3s]: train==[0.12028, 0.12019, 0.00009]
valid:{'recall': 0.14974958, 'hit_ratio': 0.952, 'precision': 0.31564996, 'ndcg': 0.35638344, 'mrr': 0.6218568, 'map': 0.47969934}
test:{'recall': 0.14845948, 'hit_ratio': 0.963, 'precision': 0.31424987, 'ndcg': 0.35463658, 'mrr': 0.6197404, 'map': 0.48054856}
Epoch 105 [19.2s]: train==[0.11941, 0.11932, 0.00009]
Epoch 106 [19.1s]: train==[0.11833, 0.11824, 0.00009]
Epoch 107 [19.2s]: train==[0.11614, 0.11605, 0.00009]
Epoch 108 [20.2s]: train==[0.11361, 0.11351, 0.00009]
Epoch 109 [19.3s]: train==[0.11449, 0.11439, 0.00009]
valid:{'recall': 0.14972445, 'hit_ratio': 0.952, 'precision': 0.31649995, 'ndcg': 0.35654062, 'mrr': 0.6203597, 'map': 0.47925308}
test:{'recall': 0.14847387, 'hit_ratio': 0.964, 'precision': 0.3143999, 'ndcg': 0.35379538, 'mrr': 0.61210674, 'map': 0.47966677}
Epoch 110 [19.1s]: train==[0.11465, 0.11456, 0.00009]
Epoch 111 [19.2s]: train==[0.11313, 0.11304, 0.00010]
Epoch 112 [19.2s]: train==[0.11219, 0.11210, 0.00010]
Epoch 113 [19.4s]: train==[0.11152, 0.11142, 0.00010]
Epoch 114 [19.1s]: train==[0.11254, 0.11244, 0.00010]
valid:{'recall': 0.14943905, 'hit_ratio': 0.949, 'precision': 0.3161501, 'ndcg': 0.3561256, 'mrr': 0.6167336, 'map': 0.4795087}
test:{'recall': 0.14794372, 'hit_ratio': 0.965, 'precision': 0.31389996, 'ndcg': 0.3536184, 'mrr': 0.6132793, 'map': 0.48032928}
Epoch 115 [19.2s]: train==[0.11095, 0.11086, 0.00010]
Epoch 116 [19.2s]: train==[0.10940, 0.10930, 0.00010]
Epoch 117 [19.2s]: train==[0.10949, 0.10939, 0.00010]
Epoch 118 [21.0s]: train==[0.10838, 0.10828, 0.00010]
Epoch 119 [19.3s]: train==[0.10828, 0.10818, 0.00010]
valid:{'recall': 0.14932351, 'hit_ratio': 0.949, 'precision': 0.31605002, 'ndcg': 0.35562894, 'mrr': 0.61574394, 'map': 0.4780757}
test:{'recall': 0.14813574, 'hit_ratio': 0.964, 'precision': 0.31334996, 'ndcg': 0.3520081, 'mrr': 0.6075712, 'map': 0.47852293}
Epoch 120 [19.1s]: train==[0.10656, 0.10646, 0.00010]
Epoch 121 [19.2s]: train==[0.10594, 0.10584, 0.00010]
Epoch 122 [19.2s]: train==[0.10645, 0.10635, 0.00010]
Epoch 123 [19.3s]: train==[0.10556, 0.10546, 0.00010]
Epoch 124 [19.5s]: train==[0.10438, 0.10428, 0.00010]
valid:{'recall': 0.14885986, 'hit_ratio': 0.947, 'precision': 0.31590027, 'ndcg': 0.354903, 'mrr': 0.6115337, 'map': 0.47585353}
test:{'recall': 0.14649622, 'hit_ratio': 0.962, 'precision': 0.31195, 'ndcg': 0.35023382, 'mrr': 0.60294634, 'map': 0.47828963}
Epoch 125 [19.1s]: train==[0.10287, 0.10277, 0.00010]
Epoch 126 [19.1s]: train==[0.10284, 0.10274, 0.00010]
Epoch 127 [19.2s]: train==[0.10123, 0.10113, 0.00011]
Epoch 128 [19.3s]: train==[0.10180, 0.10170, 0.00011]
Epoch 129 [19.2s]: train==[0.10205, 0.10194, 0.00011]
valid:{'recall': 0.14815506, 'hit_ratio': 0.948, 'precision': 0.31405005, 'ndcg': 0.35252324, 'mrr': 0.6088765, 'map': 0.4721967}
test:{'recall': 0.14652002, 'hit_ratio': 0.959, 'precision': 0.31120005, 'ndcg': 0.34952396, 'mrr': 0.60700816, 'map': 0.47558102}
Epoch 130 [19.3s]: train==[0.10062, 0.10051, 0.00011]
Epoch 131 [19.2s]: train==[0.10060, 0.10049, 0.00011]
Epoch 132 [19.2s]: train==[0.09851, 0.09840, 0.00011]
Epoch 133 [19.4s]: train==[0.09769, 0.09758, 0.00011]
Epoch 134 [19.1s]: train==[0.09798, 0.09787, 0.00011]
valid:{'recall': 0.14777514, 'hit_ratio': 0.95, 'precision': 0.31355008, 'ndcg': 0.35154375, 'mrr': 0.60603774, 'map': 0.47157744}
test:{'recall': 0.14680284, 'hit_ratio': 0.961, 'precision': 0.31014982, 'ndcg': 0.34849536, 'mrr': 0.60329115, 'map': 0.4744198}
The best epoch is  84, total training cost is 2611.7
valid:{'recall': 0.14908111, 'hit_ratio': 0.952, 'precision': 0.31369987, 'ndcg': 0.3552816, 'mrr': 0.62060034, 'map': 0.481097}
test:{'recall': 0.15061444, 'hit_ratio': 0.969, 'precision': 0.31484988, 'ndcg': 0.3561375, 'mrr': 0.6216373, 'map': 0.48193344}
